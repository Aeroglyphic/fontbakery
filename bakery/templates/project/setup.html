{% extends "project/base.html" %}
{% set page_title = _("Setup Repository") %}

{% block body %}

{% from 'project/macros.html' import nav with context%}
{{ nav('setup') }}

<form id="setup" class="form-horizontal" action="{{ url_for('project.setup', project_id = project.id)}}" method="POST">
  <div class="control-group">
    <label class="control-label" for="license_file">License file</label>
    <div class="controls">
    <select for="license_file" name="license_file" class="input-xxlarge">
      <option>Select file</option>
      {% for i in project.state['txt_files'] %}
      <option {% if project.state['license_file']==i %}selected="selected"{% endif %} >{{ i }}</option>
      {% endfor %}
    </select>
    </div>
  </div>

  <div class="control-group">
    <label class="control-label" for="ufo_folders">Ufo folders</label>
    <div class="controls">
    <select for="ufo_folders" multiple="multiple" name="ufo_dirs" class="input-xxlarge" size="{{ project.state['ufo_dirs']|length }}">
      {% for i in project.state['ufo_dirs'] %}
      <option {% if i in project.state['out_ufo'].keys() %}selected="selected"{% endif %}>{{ i }}</option>
      {% endfor %}
    </select>
    </div>
  </div>

  <div class="control-group">
    <label class="control-label" for="subset">Subset checks</label>
    <div class="controls">
    <select for="subset" multiple="multiple" name="subset" class="input-xxlarge" size="{{ subsetvals|length }}">
      {% for i in subsetvals %}
      <option {% if i in project.state['subset'] %}selected="selected"{% endif %}>{{ i }}</option>
      {% endfor %}
    </select>
    </div>
  </div>

  <div class="control-group">
    <div class="controls">
    <label class="radio">
      <input type="radio" name="rename" id="rename1" value="no" {% if not project.state['rename'] %}checked{% endif %}>
      Use the same font family name?
    </label>
    <label class="radio">
      <input type="radio" name="rename" id="reanme2" value="yes" {% if project.state['rename'] %}checked{% endif %}>
      I want to define new font family name?
    </label>
    </div>
  </div>

  <div id="familyname" class="control-group hidden">
    <label class="control-label" for="familyname">Define new font family name</label>
    <div class="controls">
    <input type="text" placeholder="Type new params…" name="familyname" 
      {% if project.config['state'].get('familyname', None) %}value="{{ project.config['state']['familyname'] }}"{% endif %} 
      class="input-xxlarge">
    </div>
  </div>

  <div class="control-group">
    <div class="controls">
    <label class="radio">
      <input type="radio" name="ttfautohintuse" id="ttf1" value="no" {% if not project.state['ttfautohintuse'] %}checked{% endif %}>
      Don't use <code>ttfautohint</code> processing
    </label>
    <label class="radio">
      <input type="radio" name="ttfautohintuse" id="ttf2" value="yes" {% if project.state['ttfautohintuse'] %}checked{% endif %}>
      I need <code>ttfautohint</code> 
    </label>
    </div>
  </div>


  <div class="control-group">
    <label class="control-label" for="ttfautohint"><code>ttfautohint</code> params</label>
    <div class="controls">
    <input type="text" placeholder="Type new params…" name="ttfautohint" {% if project.state.has_key('ttfautohint') %}value="{{ project.state['ttfautohint'] }}"{% endif %} class="input-xxlarge">
    </div>
  </div>

  <div class="control-group">
    <div class="controls">
      <button type="submit" class="btn btn-primary" {% if not project.state.get('autoprocess') %} data-confirm="Do you have permission to use the fonts names as presented to the user in modified versions?"{% endif %}>Build Font</button>
    </div>
  </div>
</form>

{% endblock %}


{% block extrajs %}

<script>
$(document).ready(function() {
    $('button[data-confirm]').click(function(ev) {

        var form = $(this).closest('form');

        if (!$('#dataConfirmModal').length) {
            $('body').append('<div id="dataConfirmModal" class="modal" role="dialog" aria-labelledby="dataConfirmLabel" aria-hidden="true"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button><h3 id="dataConfirmLabel">RFN Permission</h3></div><div class="modal-body"></div><div class="modal-footer"><button class="btn pull-left" data-dismiss="modal" aria-hidden="true">Cancel</button><a class="btn btn-success" id="dataConfirmYes">Yes</a><a class="btn btn-danger" id="dataConfirmNo">No</a></div></div>');
        } 
        $('#dataConfirmModal').find('.modal-body').text($(this).attr('data-confirm'));
        $('#dataConfirmYes').click(function(ev){
            form.submit();
        });
        $('#dataConfirmNo').click(function(ev){
          $('#reanme2').prop('checked',true);
          form.submit();
        });
        $('#dataConfirmModal').modal({show:true});
        return false;
    });
});
</script>


</div>
{% endblock %}

